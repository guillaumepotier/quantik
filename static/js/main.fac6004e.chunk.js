(this.webpackJsonpquantik=this.webpackJsonpquantik||[]).push([[0],{26:function(e,t,a){e.exports=a(92)},31:function(e,t,a){},32:function(e,t,a){},74:function(e,t,a){},90:function(e,t,a){},91:function(e,t,a){},92:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(22),i=a.n(l),s=(a(31),a(32),a(10)),c=a(2),o=a(8),u=a(24),m=a(23),h=a(25),d=a(9),v=a.n(d);a(74);var f=function(e){var t=e.type,a=e.color,n=e.allowed,l=e.onPieceClick;return r.a.createElement("div",{className:"Piece Piece--".concat(n?"allowed":"notAllowed"," Piece--").concat(a," Piece--").concat(t),onClick:l})},p=a(1),y=a.n(p),w=function e(t){Object(c.a)(this,e),this.color=t,this.pieces=["square","square","triangle","triangle","circle","circle","cross","cross"],this.lastPlay=!1},E=function(e,t,a,n,r){var l,i,s=g(t,a);for(l=0;l<=3;l++)for(i=0;i<=3;i++){if(e[t][i]&&e[t][i].piece===n&&e[t][i].color!==r)return!1;if(e[l][a]&&e[l][a].piece===n&&e[l][a].color!==r)return!1;if(e[l][i]&&g(l,i)===s&&e[l][i].piece===n&&e[l][i].color!==r)return!1}return!0},g=function(e,t){return e<=1?t<=1?0:2:t<=1?1:3},C=function(e,t){var a,n,r=[[],[],[],[]],l=[[],[],[],[]],i=[[],[],[],[]],s=["square","triangle","circle","cross"];for(a=0;a<=3;a++)for(n=0;n<=3;n++){var c=e[a][n].piece;e[a][n]&&(r[a].push(c),l[n].push(c),i[g(a,n)].push(c))}for(var o=0;o<=3;o++)if(4===r[o].length||4===l[o].length||4===i[o].length){if(4===y()(r[o],s).length)return!t||{what:"row",where:o};if(4===y()(l[o],s).length)return!t||{what:"col",where:o};if(4===y()(i[o],s).length)return!t||{what:"zone",where:o}}return!1},b=function(e){for(var t={0:!0,1:!0,2:!0,3:!0},a={0:!0,1:!0,2:!0,3:!0},n=0;n<=3;n++)for(var r=0;r<=3;r++)e[n][r]&&(a[r]=!1,t[n]=!1);return{rows:t,cols:a}},k=function(e){var t=new w(e.color);return t.pieces=e.pieces.slice(),t},N=function(e,t,a,n,r){e[n][r]={piece:a,color:t.color},function(e,t){e.pieces.splice(e.pieces.findIndex((function(e){return e===t})),1)}(t,a),t.lastPlay={piece:a,x:n,y:r}},S=function(e,t,a,n,r){e[n][r]=!1,t.pieces.push(a),t.lastPlay=!1},P=function(e){if(e<=1e3)return e;if(e<=1e6)return"".concat(Math.floor(e/1e3),"k+");var t=Math.floor(e/1e6),a=Math.floor((e-1e6*t)/1e5);return"".concat(t,",").concat(a,"M+")},I=function(e){if(e<=1e3)return"".concat(e,"ms");var t=Math.floor(e/1e3),a=Math.floor((e-1e3*t)/100);return"".concat(t,",").concat(a,"s")},A=function(e,t,a){var n=JSON.parse(window.localStorage.getItem("quantik:results"))||[];n.push({w:e,d:t,t:(new Date).getTime(),f:!a}),window.localStorage.setItem("quantik:results",JSON.stringify(n))};window.doMove=N,window.players=[new w("white"),new w("black")];a(90);var x=function(e){var t=e.x,a=e.y,n=e.board,l=e.onCellClick,i=e.chosen,s=e.won,c=t===i.x&&a===i.y,o=g(t,a),u=!1;return s&&("row"===s.what&&s.where===t||"col"===s.what&&s.where===a||"zone"===s.what&&s.where===o)&&(u=!0),r.a.createElement("div",{className:"Cell CellX--".concat(t," CellY--").concat(a," CellZone--").concat(o," Cell--").concat(c?"chosen":"notChosen"," Cell--").concat(u?"winning":"notWinning"),onClick:l},n&&n[t][a]&&r.a.createElement(f,{type:n[t][a].piece,color:n[t][a].color}))};window.evaluatedMoves=0;var M=function(){function e(){Object(c.a)(this,e)}return Object(o.a)(e,[{key:"getAvailableSituations",value:function(e,t,a,n){for(var r=[],l=t[a?1:0],i=v()(l.pieces),s=0;s<=3;s++)for(var c=0;c<=3;c++)if(!e[s][c]){if(n){var o=b(e),u=o.rows,m=o.cols;if(!u[s]||!m[c])continue}for(var h=0;h<i.length;h++){var d=i[h];E(e,s,c,d,l.color)&&r.push({x:s,y:c,piece:d})}}return r}},{key:"play",value:function(e,t,a){this.evaluatedMoves=0;var n=!1,r=!1,l=this.getAvailableSituations(e.board,e.players,!0),i=[k(e.players[0]),k(e.players[1])];if(a)var s=[[{},{},{},{}],[{},{},{},{}],[{},{},{},{}],[{},{},{},{}]];8===e.players[1].pieces.length&&(t=0),7===e.players[1].pieces.length&&(t=Math.max(0,t-1),l=this.getAvailableSituations(e.board,e.players,!0,!0));for(var c=0;c<l.length;c++){var o=l[c];N(e.board,i[1],o.piece,o.x,o.y);var u=this.minmax(e.board,t,i,!0);S(e.board,i[1],o.piece,o.x,o.y),a&&(s[o.x][o.y][o.piece]=u),(!1===n||u>n||u===n&&Math.random()<.1)&&(n=u,r=o)}return!1!==r&&(N(e.board,e.players[1],r.piece,r.x,r.y),a?(console.log("playv2 best situation",r.x,r.y,r.piece,n),s):e)}},{key:"max",value:function(e,t,a,n){for(var r,l=!1,i=0;i<e.length;i++){var s=e[i];N(a,n[1],s.piece,s.x,s.y);var c=this.minmax(a,t,n,!0);if(S(a,n[1],s.piece,s.x,s.y),(!1===l||c>l||c===l&&Math.random()<.1)&&(l=c,r=s),l>=1e3-n[1].pieces.length)break}return{best:l,bestSituation:r}}},{key:"min",value:function(e,t,a,n){for(var r,l=!1,i=0;i<e.length;i++){var s=e[i];N(a,n[0],s.piece,s.x,s.y);var c=this.minmax(a,t,n,!1);if(S(a,n[0],s.piece,s.x,s.y),(!1===l||c<l||c===l&&Math.random()<.1)&&(l=c,r=s),l<=-1e3-n[0].pieces.length)break}return{best:l,bestSituation:r}}},{key:"minmax",value:function(e,t,a,n){var r=C(e);if(0===t||r)return this.evaluate(e,a,n,r);var l=this.getAvailableSituations(e,a,!n);return n?this.min(l,t-1,e,a).best:this.max(l,t-1,e,a).best}},{key:"evaluate",value:function(e,t,a,n){return this.evaluatedMoves++,(n="undefined"===typeof n?C(e):n)?(a?1:-1)*(1e3-t[a?1:0].pieces.length):100}}]),e}(),R=(a(91),5),O=new M,j=function(){return{board:[[!1,!1,!1,!1],[!1,!1,!1,!1],[!1,!1,!1,!1],[!1,!1,!1,!1]],players:[new w("white"),new w("black")],turn:0,chosen:!1,iaComputing:!1,iaLog:!1,needRestart:!1,won:!1,showRules:!1,showStats:!1,iaFirst:!1}},G=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state=Object(s.a)({},j(),{withIA:!0,iaLevel:R}),a}return Object(h.a)(t,e),Object(o.a)(t,[{key:"onCellClick",value:function(e,t){this.state.board[e][t]||this.state.needRestart||this.setState({chosen:{x:e,y:t}})}},{key:"onPieceClick",value:function(e,t){var a=this,n=this.state,r=n.chosen,l=n.turn,i=n.players,s=n.board,c=n.withIA,o=n.iaLevel,u=r.x,m=r.y,h=i[l%2];N(s,h,e,u,m);var d=C(s,!0);if(!1!==d)return alert("Congrats player ".concat(h.color,"!")),this.setState({needRestart:!0,chosen:!1,won:d}),void(c&&A("white"===h.color,o,this.state.iaFirst));this.setState({board:s,players:i,turn:l+1,chosen:!1},(function(){c&&(a.setState({iaComputing:!0}),setTimeout((function(){return a.IAPlay()}),300))}))}},{key:"iaFirst",value:function(){this.IAPlay(),this.setState({iaFirst:!0,turn:0})}},{key:"IAPlay",value:function(){var e=this,t=this.state.iaLevel,a=new Date,n=O.play(this.state,this.state.iaLevel),r=new Date;if(console.log("IA took ".concat(r-a,"ms to play")),!1===n)return alert("Congrats white! IA has no move left to play, you won!"),this.setState({needRestart:!0,chosen:!1}),void A(!0,t,this.state.iaFirst);this.setState(Object(s.a)({},n,{iaLog:"IA evaluated ".concat(P(O.evaluatedMoves)," possible moves in ").concat(I(r-a),"."),turn:this.state.turn+1,iaComputing:!1}),(function(){var a=C(e.state.board,!0);!1!==a&&(alert("Congrats IA, you won! Guillaume is proud of you!"),e.setState({needRestart:!0,chosen:!1,won:a}),A(!1,t,e.state.iaFirst))}))}},{key:"undoMove",value:function(){var e=this.state,t=e.board,a=e.players,n=e.turn;S(t,a[1],a[1].lastPlay.piece,a[1].lastPlay.x,a[1].lastPlay.y),S(t,a[0],a[0].lastPlay.piece,a[0].lastPlay.x,a[0].lastPlay.y),this.setState({board:t,players:a,turn:n-2})}},{key:"renderGrid",value:function(e){for(var t=this,a=[],n=this.state,l=n.chosen,i=n.won,s=function(n){for(var s=function(s){a.push(r.a.createElement(x,{chosen:l,won:i,key:"".concat(n,":").concat(s),x:n,y:s,board:e,onCellClick:function(){return t.onCellClick(n,s)}}))},c=0;c<=3;c++)s(c)},c=0;c<=3;c++)s(c);return a}},{key:"renderPlayerPieces",value:function(e){for(var t=[],a=0;a<e.pieces.length;a++)t.push(r.a.createElement("span",{key:a,className:"PlayerPiece"},r.a.createElement(f,{color:e.color,type:e.pieces[a]})));return t}},{key:"showAffiliateIFrame",value:function(){return r.a.createElement("div",{className:"Credentials"},r.a.createElement("div",null,"QUANTIK is a GIGAMIC original board game."),r.a.createElement("img",{src:"//ir-fr.amazon-adsystem.com/e/ir?t=guillaumepoti-21&l=am2&o=8&a=B07YN2YRM4",width:"1",height:"1",border:"0",alt:"",style:{border:"none !important",margin:"0px !important"}}),r.a.createElement("div",null,"This project is free and open source, I'm not affiliated in any way with GIGAMIC. If you like the game, please consider buying it by clicking ",r.a.createElement("a",{target:"_blank",href:"https://www.amazon.fr/gp/product/B07YN2YRM4/ref=as_li_tl?ie=UTF8&camp=1642&creative=6746&creativeASIN=B07YN2YRM4&linkCode=as2&tag=guillaumepoti-21&linkId=5e4c14952269b4674511f3d6b0282fcb"},"on this Amazon affiliate link"),"."))}},{key:"render",value:function(){var e,t,a,n=this,l=this.state,i=l.board,c=l.players,o=l.turn,u=l.chosen,m=l.showRules,h=l.showStats,d=u.x,p=u.y,y=c[o%2],w=u?v()(y.pieces).filter((function(e){return E(i,d,p,e,y.color)})):[],g=[];return h&&(g=JSON.parse(window.localStorage.getItem("quantik:results"))||[],console.log(g),e=g.filter((function(e){return 3===e.d})),t=g.filter((function(e){return 5===e.d})),a=g.filter((function(e){return 6===e.d}))),r.a.createElement("div",{className:"Game"},r.a.createElement("div",{className:"Header"},r.a.createElement("div",{className:"Header-rules",onClick:function(){return n.setState({showRules:!0})}},r.a.createElement("small",null,"Rules")),r.a.createElement("div",{className:"Header-title"},"Quantik"),r.a.createElement("div",{className:"Header-stats",onClick:function(){return n.setState({showStats:!0})}},r.a.createElement("small",null,"Stats"))),m&&r.a.createElement("div",{className:"Modal Rules"},r.a.createElement("p",null,"The object of the game is to be the first player to lay the fourth different shape of a row, column or square area."),r.a.createElement("p",null,"In turn, the players take turns placing one of their pieces on the board. It is forbidden to place a shape in a row, column or area on which the same shape has already been placed by the opponent. You can only double a shape if you have played the previous one yourself."),r.a.createElement("p",null,"The first player who places the fourth different shape in a row, column or area immediately wins the game, regardless of who owns the other pieces in that winning move."),r.a.createElement("p",null,"If a player has no more possible moves, then he has lost."),r.a.createElement("p",{onClick:function(){return n.setState({showRules:!1})}},"Close")),h&&r.a.createElement("div",{className:"Modal Stats"},r.a.createElement("div",{className:"StatsCard"},r.a.createElement("div",{className:"StatsCard-title"},"Played games"),r.a.createElement("div",{className:"StatsCard-value"},g.length)),r.a.createElement("div",{className:"StatsCardGroup"},r.a.createElement("div",{className:"StatsCard"},r.a.createElement("div",{className:"StatsCard-title"},"IA Easy plays"),r.a.createElement("div",{className:"StatsCard-value"},e.length)),r.a.createElement("div",{className:"StatsCard"},r.a.createElement("div",{className:"StatsCard-title"},"Winrate"),r.a.createElement("div",{className:"StatsCard-value"},0!==e.length?"".concat(Math.round(e.filter((function(e){return!0===e.w})).length/e.length*100),"%"):"--"))),r.a.createElement("div",{className:"StatsCardGroup"},r.a.createElement("div",{className:"StatsCard"},r.a.createElement("div",{className:"StatsCard-title"},"IA Medium plays"),r.a.createElement("div",{className:"StatsCard-value"},t.length)),r.a.createElement("div",{className:"StatsCard"},r.a.createElement("div",{className:"StatsCard-title"},"Winrate"),r.a.createElement("div",{className:"StatsCard-value"},0!==t.length?"".concat(Math.round(t.filter((function(e){return!0===e.w})).length/t.length*100),"%"):"--"))),r.a.createElement("div",{className:"StatsCardGroup"},r.a.createElement("div",{className:"StatsCard"},r.a.createElement("div",{className:"StatsCard-title"},"IA Hard plays"),r.a.createElement("div",{className:"StatsCard-value"},a.length)),r.a.createElement("div",{className:"StatsCard"},r.a.createElement("div",{className:"StatsCard-title"},"Winrate"),r.a.createElement("div",{className:"StatsCard-value"},0!==a.length?"".concat(Math.round(a.filter((function(e){return!0===e.w})).length/a.length*100),"%"):"--"))),r.a.createElement("p",{onClick:function(){return n.setState({showStats:!1})}},"Close")),r.a.createElement("div",{className:"GameContent"},r.a.createElement("div",{className:"Parameters"},r.a.createElement("div",{className:"HumanOrIa"},r.a.createElement("span",null,"Player vs."),r.a.createElement("span",null,"Player",r.a.createElement("input",{type:"radio",name:"player2",value:"IA",checked:!this.state.withIA,onChange:function(){return n.setState({withIA:!1})}}),"IA",r.a.createElement("input",{type:"radio",name:"player2",value:"human",checked:this.state.withIA,onChange:function(){return n.setState({withIA:!0})}}))),this.state.withIA&&r.a.createElement("div",{className:"IALevel"},r.a.createElement("label",{htmlFor:"ia_level"},"IA Difficulty"),r.a.createElement("select",{id:"ia_level",name:"ia_level",value:this.state.iaLevel,onChange:function(e){return n.setState({iaLevel:parseInt(e.target.value,10)})}},r.a.createElement("option",{value:3},"Easy"),r.a.createElement("option",{value:R},"Medium"),r.a.createElement("option",{value:6},"Hard")),0===this.state.turn&&r.a.createElement("button",{onClick:function(){return n.iaFirst()}},"IA plays first")),!this.state.needRestart&&r.a.createElement("div",null,r.a.createElement("span",{className:"PlayerTurn"},"Player ",y.color," turn"),c[0].lastPlay&&c[1].lastPlay&&r.a.createElement("button",{onClick:function(){return n.undoMove()}},"Undo previous")),this.state.needRestart&&r.a.createElement("button",{onClick:function(){n.setState(Object(s.a)({},n.state,{},j()))}},"New game!")),r.a.createElement("div",{className:"Board"},this.renderGrid(i)),r.a.createElement("div",{className:"PlayerPieces"},r.a.createElement("div",{className:"PlayerPieces-white"},r.a.createElement("div",{className:"PlayerPieces-whiteLabel"},"white:"),r.a.createElement("div",{className:"PlayerPieces-draw"},this.renderPlayerPieces(c[0]))),r.a.createElement("div",{className:"PlayerPieces-black"},r.a.createElement("div",{className:"PlayerPieces-blackLabel"},"black:"),r.a.createElement("div",{className:"PlayerPieces-draw"},this.renderPlayerPieces(c[1])))),r.a.createElement("div",{className:"Controls"},this.state.iaComputing&&r.a.createElement("small",null,"IA is computing.."),this.state.iaLog&&!this.state.iaComputing&&r.a.createElement("small",null,this.state.iaLog),r.a.createElement("div",{className:"Choice"},u&&r.a.createElement("div",{className:"ChoiceWrapper"},r.a.createElement("div",{className:"Choice-title"},"Allowed pieces"),r.a.createElement("div",{className:"Close",onClick:function(){return n.setState({chosen:!1})}},"X"),r.a.createElement("div",{className:"Choice-pieces"},!w.length&&r.a.createElement("span",null,"None! ",r.a.createElement("span",{role:"img","aria-label":"sad"},"\ud83d\ude30")),w.map((function(e,t){return!!E(i,d,p,e,y.color)&&r.a.createElement(f,{key:t,color:y.color,type:e,allowed:!0,onPieceClick:function(){return n.onPieceClick(e,t)}})}))))))),r.a.createElement("div",null,this.showAffiliateIFrame()),r.a.createElement("div",{className:"Version"},r.a.createElement("a",{href:"https://github.com/guillaumepotier/quantik",target:"_blank"},"Github source")," - v0.7.1"))}}]),t}(r.a.Component);var L=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(G,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(L,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[26,1,2]]]);
//# sourceMappingURL=main.fac6004e.chunk.js.map