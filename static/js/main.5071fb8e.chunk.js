(this.webpackJsonpquantik=this.webpackJsonpquantik||[]).push([[0],{26:function(e,t,a){e.exports=a(92)},31:function(e,t,a){},32:function(e,t,a){},74:function(e,t,a){},90:function(e,t,a){},91:function(e,t,a){},92:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(22),s=a.n(l),i=(a(31),a(32),a(10)),o=a(2),c=a(8),u=a(24),h=a(23),m=a(25),d=a(9),v=a.n(d);a(74);var f=function(e){var t=e.type,a=e.color,n=e.allowed,l=e.onPieceClick;return r.a.createElement("div",{className:"Piece Piece--".concat(n?"allowed":"notAllowed"," Piece--").concat(a," Piece--").concat(t),onClick:l})},p=a(1),y=a.n(p),w=function e(t){Object(o.a)(this,e),this.color=t,this.pieces=["square","square","triangle","triangle","circle","circle","cross","cross"],this.lastPlay=!1},E=function(e,t,a,n,r){var l,s,i=g(t,a);for(l=0;l<=3;l++)for(s=0;s<=3;s++){if(e[t][s]&&e[t][s].piece===n&&e[t][s].color!==r)return!1;if(e[l][a]&&e[l][a].piece===n&&e[l][a].color!==r)return!1;if(e[l][s]&&g(l,s)===i&&e[l][s].piece===n&&e[l][s].color!==r)return!1}return!0},g=function(e,t){return e<=1?t<=1?0:2:t<=1?1:3},C=function(e,t){var a,n,r=[[],[],[],[]],l=[[],[],[],[]],s=[[],[],[],[]],i=["square","triangle","circle","cross"];for(a=0;a<=3;a++)for(n=0;n<=3;n++){var o=e[a][n].piece;e[a][n]&&(r[a].push(o),l[n].push(o),s[g(a,n)].push(o))}for(var c=0;c<=3;c++)if(4===r[c].length||4===l[c].length||4===s[c].length){if(4===y()(r[c],i).length)return!t||{what:"row",where:c};if(4===y()(l[c],i).length)return!t||{what:"col",where:c};if(4===y()(s[c],i).length)return!t||{what:"zone",where:c}}return!1},S=function(e){for(var t={0:!0,1:!0,2:!0,3:!0},a={0:!0,1:!0,2:!0,3:!0},n=0;n<=3;n++)for(var r=0;r<=3;r++)e[n][r]&&(a[r]=!1,t[n]=!1);return{rows:t,cols:a}},b=function(e){var t=new w(e.color);return t.pieces=e.pieces.slice(),t},k=function(e,t,a,n,r){e[n][r]={piece:a,color:t.color},function(e,t){e.pieces.splice(e.pieces.findIndex((function(e){return e===t})),1)}(t,a),t.lastPlay={piece:a,x:n,y:r}},N=function(e,t,a,n,r){e[n][r]=!1,t.pieces.push(a),t.lastPlay=!1},I=function(e){if(e<=1e3)return e;if(e<=1e6)return"".concat(Math.floor(e/1e3),"k+");var t=Math.floor(e/1e6),a=Math.floor((e-1e6*t)/1e5);return"".concat(t,",").concat(a,"M+")},A=function(e){if(e<=1e3)return"".concat(e,"ms");var t=Math.floor(e/1e3),a=Math.floor((e-1e3*t)/100);return"".concat(t,",").concat(a,"s")},x=function(e,t){var a=JSON.parse(window.localStorage.getItem("quantik:results"))||[];a.push({w:e,d:t,t:(new Date).getTime()}),window.localStorage.setItem("quantik:results",JSON.stringify(a))};window.doMove=k,window.players=[new w("white"),new w("black")];a(90);var P=function(e){var t=e.x,a=e.y,n=e.board,l=e.onCellClick,s=e.chosen,i=e.won,o=t===s.x&&a===s.y,c=g(t,a),u=!1;return i&&("row"===i.what&&i.where===t||"col"===i.what&&i.where===a||"zone"===i.what&&i.where===c)&&(u=!0),r.a.createElement("div",{className:"Cell CellX--".concat(t," CellY--").concat(a," CellZone--").concat(c," Cell--").concat(o?"chosen":"notChosen"," Cell--").concat(u?"winning":"notWinning"),onClick:l},n&&n[t][a]&&r.a.createElement(f,{type:n[t][a].piece,color:n[t][a].color}))};window.evaluatedMoves=0;var M=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,[{key:"getAvailableSituations",value:function(e,t,a,n){for(var r=[],l=t[a?1:0],s=v()(l.pieces),i=0;i<=3;i++)for(var o=0;o<=3;o++)if(!e[i][o]){if(n){var c=S(e),u=c.rows,h=c.cols;if(!u[i]||!h[o])continue}for(var m=0;m<s.length;m++){var d=s[m];E(e,i,o,d,l.color)&&r.push({x:i,y:o,piece:d})}}return r}},{key:"play",value:function(e,t,a){this.evaluatedMoves=0;var n=!1,r=!1,l=this.getAvailableSituations(e.board,e.players,!0),s=[b(e.players[0]),b(e.players[1])];if(a)var i=[[{},{},{},{}],[{},{},{},{}],[{},{},{},{}],[{},{},{},{}]];8===e.players[1].pieces.length&&(t=0),7===e.players[1].pieces.length&&(t=Math.max(0,t-1),l=this.getAvailableSituations(e.board,e.players,!0,!0));for(var o=0;o<l.length;o++){var c=l[o];k(e.board,s[1],c.piece,c.x,c.y);var u=this.minmax(e.board,t,s,!0);N(e.board,s[1],c.piece,c.x,c.y),a&&(i[c.x][c.y][c.piece]=u),(!1===n||u>n||u===n&&Math.random()<.1)&&(n=u,r=c)}return!1!==r&&(k(e.board,e.players[1],r.piece,r.x,r.y),a?(console.log("playv2 best situation",r.x,r.y,r.piece,n),i):e)}},{key:"max",value:function(e,t,a,n){for(var r,l=!1,s=0;s<e.length;s++){var i=e[s];k(a,n[1],i.piece,i.x,i.y);var o=this.minmax(a,t,n,!0);if(N(a,n[1],i.piece,i.x,i.y),(!1===l||o>l||o===l&&Math.random()<.1)&&(l=o,r=i),l>=1e3-n[1].pieces.length)break}return{best:l,bestSituation:r}}},{key:"min",value:function(e,t,a,n){for(var r,l=!1,s=0;s<e.length;s++){var i=e[s];k(a,n[0],i.piece,i.x,i.y);var o=this.minmax(a,t,n,!1);if(N(a,n[0],i.piece,i.x,i.y),(!1===l||o<l||o===l&&Math.random()<.1)&&(l=o,r=i),l<=-1e3-n[0].pieces.length)break}return{best:l,bestSituation:r}}},{key:"minmax",value:function(e,t,a,n){var r=C(e);if(0===t||r)return this.evaluate(e,a,n,r);var l=this.getAvailableSituations(e,a,!n);return n?this.min(l,t-1,e,a).best:this.max(l,t-1,e,a).best}},{key:"evaluate",value:function(e,t,a,n){return this.evaluatedMoves++,(n="undefined"===typeof n?C(e):n)?(a?1:-1)*(1e3-t[a?1:0].pieces.length):100}}]),e}(),O=(a(91),5),R=new M,j=function(){return{board:[[!1,!1,!1,!1],[!1,!1,!1,!1],[!1,!1,!1,!1],[!1,!1,!1,!1]],players:[new w("white"),new w("black")],turn:0,chosen:!1,iaComputing:!1,iaLog:!1,needRestart:!1,won:!1,showRules:!1,showStats:!1}},L=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(h.a)(t).call(this,e))).state=Object(i.a)({},j(),{withIA:!0,iaLevel:O}),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"onCellClick",value:function(e,t){this.state.board[e][t]||this.state.needRestart||this.setState({chosen:{x:e,y:t}})}},{key:"onPieceClick",value:function(e,t){var a=this,n=this.state,r=n.chosen,l=n.turn,s=n.players,i=n.board,o=n.withIA,c=n.iaLevel,u=r.x,h=r.y,m=s[l%2];k(i,m,e,u,h);var d=C(i,!0);if(!1!==d)return alert("Congrats player ".concat(m.color,"!")),this.setState({needRestart:!0,chosen:!1,won:d}),void(o&&x("white"===m.color,c));this.setState({board:i,players:s,turn:l+1,chosen:!1},(function(){o&&(a.setState({iaComputing:!0}),setTimeout((function(){return a.IAPlay()}),300))}))}},{key:"iaFirst",value:function(){this.IAPlay(),this.setState({turn:0})}},{key:"IAPlay",value:function(){var e=this,t=this.state.iaLevel,a=new Date,n=R.play(this.state,this.state.iaLevel),r=new Date;if(console.log("IA took ".concat(r-a,"ms to play")),!1===n)return alert("Congrats white! IA has no move left to play, you won!"),this.setState({needRestart:!0,chosen:!1}),void x(!0,t);this.setState(Object(i.a)({},n,{iaLog:"IA evaluated ".concat(I(R.evaluatedMoves)," possible moves in ").concat(A(r-a),"."),turn:this.state.turn+1,iaComputing:!1}),(function(){var a=C(e.state.board,!0);!1!==a&&(alert("Congrats IA, you won! Guillaume is proud of you!"),e.setState({needRestart:!0,chosen:!1,won:a}),x(!1,t))}))}},{key:"undoMove",value:function(){var e=this.state,t=e.board,a=e.players,n=e.turn;N(t,a[1],a[1].lastPlay.piece,a[1].lastPlay.x,a[1].lastPlay.y),N(t,a[0],a[0].lastPlay.piece,a[0].lastPlay.x,a[0].lastPlay.y),this.setState({board:t,players:a,turn:n-2})}},{key:"renderGrid",value:function(e){for(var t=this,a=[],n=this.state,l=n.chosen,s=n.won,i=function(n){for(var i=function(i){a.push(r.a.createElement(P,{chosen:l,won:s,key:"".concat(n,":").concat(i),x:n,y:i,board:e,onCellClick:function(){return t.onCellClick(n,i)}}))},o=0;o<=3;o++)i(o)},o=0;o<=3;o++)i(o);return a}},{key:"render",value:function(){var e,t,a,n=this,l=this.state,s=l.board,o=l.players,c=l.turn,u=l.chosen,h=l.showRules,m=l.showStats,d=u.x,p=u.y,y=o[c%2],w=u?v()(y.pieces).filter((function(e){return E(s,d,p,e,y.color)})):[],g=[];return m&&(g=JSON.parse(window.localStorage.getItem("quantik:results"))||[],console.log(g),e=g.filter((function(e){return 3===e.d})),t=g.filter((function(e){return 5===e.d})),a=g.filter((function(e){return 6===e.d}))),r.a.createElement("div",{className:"Game"},r.a.createElement("div",{className:"Header"},r.a.createElement("div",{className:"Header-rules",onClick:function(){return n.setState({showRules:!0})}},r.a.createElement("small",null,"Rules")),r.a.createElement("div",{className:"Header-title"},"Quantik"),r.a.createElement("div",{className:"Header-stats",onClick:function(){return n.setState({showStats:!0})}},r.a.createElement("small",null,"Stats"))),h&&r.a.createElement("div",{className:"Modal Rules"},r.a.createElement("p",null,"The object of the game is to be the first player to lay the fourth different shape of a row, column or square area."),r.a.createElement("p",null,"In turn, the players take turns placing one of their pieces on the board. It is forbidden to place a shape in a row, column or area on which the same shape has already been placed by the opponent. You can only double a shape if you have played the previous one yourself."),r.a.createElement("p",null,"The first player who places the fourth different shape in a row, column or area immediately wins the game, regardless of who owns the other pieces in that winning move."),r.a.createElement("p",null,"If a player has no more possible moves, then he has lost."),r.a.createElement("p",{onClick:function(){return n.setState({showRules:!1})}},"Close")),m&&r.a.createElement("div",{className:"Modal Stats"},r.a.createElement("div",{className:"StatsCard"},r.a.createElement("div",{className:"StatsCard-title"},"Played games"),r.a.createElement("div",{className:"StatsCard-value"},g.length)),r.a.createElement("div",{className:"StatsCardGroup"},r.a.createElement("div",{className:"StatsCard"},r.a.createElement("div",{className:"StatsCard-title"},"IA Easy plays"),r.a.createElement("div",{className:"StatsCard-value"},e.length)),r.a.createElement("div",{className:"StatsCard"},r.a.createElement("div",{className:"StatsCard-title"},"Winrate"),r.a.createElement("div",{className:"StatsCard-value"},0!==e.length?"".concat(Math.round(e.filter((function(e){return!0===e.w})).length/e.length*100),"%"):"--"))),r.a.createElement("div",{className:"StatsCardGroup"},r.a.createElement("div",{className:"StatsCard"},r.a.createElement("div",{className:"StatsCard-title"},"IA Medium plays"),r.a.createElement("div",{className:"StatsCard-value"},t.length)),r.a.createElement("div",{className:"StatsCard"},r.a.createElement("div",{className:"StatsCard-title"},"Winrate"),r.a.createElement("div",{className:"StatsCard-value"},0!==t.length?"".concat(Math.round(t.filter((function(e){return!0===e.w})).length/t.length*100),"%"):"--"))),r.a.createElement("div",{className:"StatsCardGroup"},r.a.createElement("div",{className:"StatsCard"},r.a.createElement("div",{className:"StatsCard-title"},"IA Hard plays"),r.a.createElement("div",{className:"StatsCard-value"},a.length)),r.a.createElement("div",{className:"StatsCard"},r.a.createElement("div",{className:"StatsCard-title"},"Winrate"),r.a.createElement("div",{className:"StatsCard-value"},0!==a.length?"".concat(Math.round(a.filter((function(e){return!0===e.w})).length/a.length*100),"%"):"--"))),r.a.createElement("p",{onClick:function(){return n.setState({showStats:!1})}},"Close")),r.a.createElement("div",{className:"GameContent"},r.a.createElement("div",{className:"Parameters"},r.a.createElement("div",{className:"HumanOrIa"},r.a.createElement("span",null,"Player vs."),r.a.createElement("span",null,"Player",r.a.createElement("input",{type:"radio",name:"player2",value:"IA",checked:!this.state.withIA,onChange:function(){return n.setState({withIA:!1})}}),"IA",r.a.createElement("input",{type:"radio",name:"player2",value:"human",checked:this.state.withIA,onChange:function(){return n.setState({withIA:!0})}}))),this.state.withIA&&r.a.createElement("div",{className:"IALevel"},r.a.createElement("label",{htmlFor:"ia_level"},"IA Difficulty"),r.a.createElement("select",{id:"ia_level",name:"ia_level",value:this.state.iaLevel,onChange:function(e){return n.setState({iaLevel:parseInt(e.target.value,10)})}},r.a.createElement("option",{value:3},"Easy"),r.a.createElement("option",{value:O},"Medium"),r.a.createElement("option",{value:6},"Hard")),0===this.state.turn&&r.a.createElement("button",{onClick:function(){return n.iaFirst()}},"IA plays first")),!this.state.needRestart&&r.a.createElement("div",null,r.a.createElement("span",{className:"PlayerTurn"},"Player ",y.color," turn"),o[0].lastPlay&&o[1].lastPlay&&r.a.createElement("button",{onClick:function(){return n.undoMove()}},"Undo previous")),this.state.needRestart&&r.a.createElement("button",{onClick:function(){n.setState(Object(i.a)({},n.state,{},j()))}},"New game!")),r.a.createElement("div",{className:"Board"},this.renderGrid(s)),r.a.createElement("div",{className:"Controls"},this.state.iaComputing&&r.a.createElement("small",null,"IA is computing.."),this.state.iaLog&&!this.state.iaComputing&&r.a.createElement("small",null,this.state.iaLog),r.a.createElement("div",{className:"Choice"},u&&r.a.createElement("div",null,r.a.createElement("div",{className:"Choice-title"},"Allowed pieces"),r.a.createElement("div",{className:"Close",onClick:function(){return n.setState({chosen:!1})}},"X"),r.a.createElement("div",{className:"Choice-pieces"},!w.length&&r.a.createElement("span",null,"None! ",r.a.createElement("span",{role:"img","aria-label":"sad"},"\ud83d\ude30")),w.map((function(e,t){return!!E(s,d,p,e,y.color)&&r.a.createElement(f,{key:t,color:y.color,type:e,allowed:!0,onPieceClick:function(){return n.onPieceClick(e,t)}})}))))))),r.a.createElement("div",{className:"Version"},"v0.6.1"))}}]),t}(r.a.Component);var q=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(L,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(q,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[26,1,2]]]);
//# sourceMappingURL=main.5071fb8e.chunk.js.map